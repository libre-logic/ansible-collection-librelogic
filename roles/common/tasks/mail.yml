##### OUTGOING SYSTEM MAIL #####

- name: copy msmtp configuration
  template:
    src: "etc_msmtprc.j2"
    dest: "/etc/msmtprc"
    owner: root
    group: root
    mode: 0644

- name: configure the default mail alias
  lineinfile:
    path: /etc/aliases
    regexp: '^default:'
    line: "default: {{ msmtp_admin_email }}"
    create: yes

- name: install msmtp SMTP client as system MTA
  apt:
    package:
      - msmtp
      - msmtp-mta
    default_release: "{{ omit if ansible_distribution == 'Ubuntu' else 'buster-backports' }}"
    state: present

