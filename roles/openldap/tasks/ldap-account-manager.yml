---

### LDAP ACCOUNT MANAGER (WEB UI) ###

- name: Install LDAP-Account-Manager
  apt:
    state: present
    package:
      - ldap-account-manager
      - php7.0-zip
      - php7.0-xml
      - ssl-cert

- name: create configuration directories
  file:
    path: "/var/lib/ldap-account-manager/config/profiles/lam"
    owner: www-data
    group: root
    mode: 0770
    state: directory

- name: Install LDAP-Account-Manager configuration
  template: src={{ item.src }} dest={{ item.dest }} owner={{ item.owner }} group={{ item.group }} mode={{ item.mode }}
  with_items:
    - { src: "etc_ldap-account-manager_config.cfg.j2", dest: "/etc/ldap-account-manager/config.cfg", owner: "www-data", group: "root", mode: "0600" } # noqa 204
    - { src: "var_lib_ldap-account-manager_config_lam.conf.j2", dest: "/var/lib/ldap-account-manager/config/lam.conf", owner: "www-data", group: "root", mode: "0600" } # noqa 204
    - { src: "var_lib_ldap-account-manager_config_profiles_lam_default.group.j2", dest: "/var/lib/ldap-account-manager/config/profiles/lam/default.group", owner:  "www-data", group: "www-data", mode: "0644"} # noqa 204
    - { src: "var_lib_ldap-account-manager_config_profiles_lam_default.user.j2", dest: "/var/lib/ldap-account-manager/config/profiles/lam/default.user", owner:  "www-data", group: "www-data", mode: "0644"} # noqa 204

